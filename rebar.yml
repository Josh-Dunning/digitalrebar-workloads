barclamp:
  name: docker_swarm
  display: Docker Swarm
  license: "apache2"
  copyright: "RackN, Inc 2015"
  os_support:
    - centos-7.1.1503
    - centos-6.7

wizard:
  version: 1

rebar:
  layout: 2.0

roles:
  - name: docker-swarm-install
    jig: script
    requires:
      - rebar-installed-node
    flags:
      - implicit
    attribs: 
      - name: docker-swarm-version
        description: 'The version of swarm to install'
        map: 'docker_swarm/version'
        default: 'v1.0.0'
        schema:
          type: str
  - name: docker-swarm-member
    jig: script
    flags:
      - cluster
      - milestone
    requires:
      - docker-ready
      - docker-swarm-install
      - consul-member
    wants-attribs:
      - docker-port
      - consul-address
  - name: docker-swarm-manager
    jig: script
    requires:
      - docker-swarm-install
      - consul-master
    flags:
      - milestone
    wants-attribs:
      - consul-address
    attribs:
      - name: docker-swarm-manager-port
        description: 'The port that swarm maangers will listen on'
        map: 'docker_swarm/manager_port'
        default: 2475
        schema:
          type: int
